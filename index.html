<!DOCTYPE html>
<head>
    <title>AR 數位名片互動版</title>
    <meta charset="utf-8">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://raw.githack.com/fcor/arjs-gestures/master/dist/gestures.js"></script>
    
    <style>
        /* 將按鈕固定在畫面右側置中 */
        .ui-container {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            z-index: 1000; /* 確保按鈕在 3D 畫面最上層 */
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .action-btn {
            padding: 12px 20px;
            background-color: rgba(0, 0, 0, 0.6);
            color: #ffffff;
            border: 2px solid #ffffff;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            backdrop-filter: blur(4px);
            transition: 0.3s;
        }

        .action-btn:active {
            background-color: rgba(255, 255, 255, 0.8);
            color: #000000;
        }
    </style>
</head>

<body style="margin: 0; overflow: hidden;">
    
    <div class="ui-container">
        <button class="action-btn" id="btn-card">漂浮名片</button>
        <button class="action-btn" id="btn-3d">3D 模型</button>
    </div>

    <a-scene
        vr-mode-ui="enabled: false;"
        loading-screen="enabled: false;"
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
        id="scene"
        embedded
        gesture-detector
        renderer="logarithmicDepthBuffer: true; precision: medium;"
    >
        <a-assets>
            <img id="card-img" src="assets/my-card.jpg">
            <a-asset-item id="robot-model" src="assets/robot.glb"></a-asset-item>
        </a-assets>

        <a-marker
            id="animated-marker"
            type="pattern"
            preset="custom"
            url="assets/pattern-qr.ioi.tw.patt"
            raycaster="objects: .clickable"
            emitevents="true"
            cursor="fuse: false; rayOrigin: mouse;"
        >
            <a-image
                id="my-card"
                src="#card-img"
                scale="1.5 1.5 1.5"
                position="0 0.5 0"
                rotation="-90 0 0"
                class="clickable"
                visible="true"
                gesture-handler
                animation="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: 0 0.8 0"
            ></a-image>

            <a-entity
                id="my-3d"
                gltf-model="#robot-model"
                scale="1 1 1"
                position="0 0 0"
                class="clickable"
                visible="false"
                gesture-handler
            ></a-entity>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // 取得按鈕與 AR 物件
        const btnCard = document.getElementById('btn-card');
        const btn3d = document.getElementById('btn-3d');
        const myCard = document.getElementById('my-card');
        const my3d = document.getElementById('my-3d');

        // 點擊「漂浮名片」按鈕
        btnCard.addEventListener('click', () => {
            myCard.setAttribute('visible', 'true');
            my3d.setAttribute('visible', 'false');
        });

        // 點擊「3D 模型」按鈕
        btn3d.addEventListener('click', () => {
            myCard.setAttribute('visible', 'false');
            my3d.setAttribute('visible', 'true');
        });
    </script>

</body>
</html>